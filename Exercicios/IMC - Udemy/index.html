<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="assets/css/style.css" />
    <title>Modelo</title>
</head>

<body>
    <section class="container">
        <h1>Tabela IMC</h1>
        <table class="tabelaIMC">
            <thead>
                <tr>
                    <th>IMC</th>
                    <th>Resultado</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Menos de 18,5</td>
                    <td>Abaixo do peso</td>
                </tr>
                <tr>
                    <td>18,5 - 24,9</td>
                    <td>Peso normal</td>
                </tr>
                <tr>
                    <td>25 - 29,9</td>
                    <td>Sobrepeso</td>
                </tr>
                <tr>
                    <td>30 - 34,9</td>
                    <td>Obesidade</td>
                </tr>
                <tr>
                    <td>35 - 39,9</td>
                    <td>Obesidade Grave</td>
                </tr>
                <tr>
                    <td>40 ou mais</td>
                    <td>Obesidade Mórbida</td>
                </tr>
            </tbody>
        </table>

        <form onsubmit="return false">
            <label for="ipeso">Peso (kg)</label>
            <input type="text" id="ipeso" oninput="formatarPeso(this)" inputmode="decimal" />
            <label for="ialtura">Altura (m)</label>
            <input type="text" id="ialtura" inputmode="decimal" oninput="formatarAltura(this)" />
            <input type="button" value="Calcular" class="button" onclick="calcular()">
            <input type="reset" value="Limpar" class="button" onclick="limpar()">
        </form>
        <div id="resultado"></div>
    </section>
    <script>
        const peso = document.getElementById('ipeso')
        const altura = document.getElementById('ialtura')
        const res = document.getElementById('resultado')
        function calculo(peso, altura) {
            const imc = peso / (altura ** 2);
            const imcFixado = imc.toFixed(1);

            if (imc < 18.5) {
                res.innerHTML = `IMC: ${imcFixado} | Abaixo do peso`;
            } else if (imc >= 18.5 && imc <= 24.9) {
                res.innerHTML = `IMC: ${imcFixado} | Peso normal`;
            } else if (imc >= 25 && imc <= 29.9) {
                res.innerHTML = `IMC: ${imcFixado} | Sobrepeso`;
            } else if (imc >= 30 && imc <= 34.9) {
                res.innerHTML = `IMC: ${imcFixado} | Obesidade`;
            } else if (imc >= 35 && imc <= 39.9) {
                res.innerHTML = `IMC: ${imcFixado} | Obesidade Grave`;
            } else {
                res.innerHTML = `IMC: ${imcFixado} | Obesidade Mórbida`;
            }
        }
        function calcular() {
            const pesoTexto = peso.value.trim().replace(',', '.')
            const alturaTexto = altura.value.trim().replace(',', '.')

            if (!pesoTexto || !alturaTexto) {
                window.alert('Preencha todos os campos!')
                return
            }

            const pesoValor = Number(pesoTexto);
            const alturaValor = Number(alturaTexto);

            if (pesoValor <= 0 || alturaValor <= 0) {
                window.alert('Os valores devem ser maior que zero')
                return
            }
            if (isNaN(pesoValor) || isNaN(alturaValor)) {
                window.alert('Digite apenas números válidos!');
                return
            }
            calculo(pesoValor, alturaValor)
        }
        function formatarAltura(campo) {
            // Remove tudo que não for número
            let valor = campo.value.replace(/\D/g, '');

            // Se o usuário digitar '185', vira '1,85'
            if (valor.length === 3) {
                valor = valor[0] + ',' + valor.slice(1);
            }

            // Se digitar '1750', vira '1,75' (descarta extra)
            else if (valor.length > 3) {
                valor = valor[0] + ',' + valor.slice(1, 3);
            }

            campo.value = valor;
        }
        function formatarPeso(campo) {
            // Remove tudo que não for número (mantém só dígitos)
            let valor = campo.value.replace(/\D/g, '');

            // Se tiver até 2 dígitos, exibe apenas eles (ex: "75")
            if (valor.length <= 2) {
                campo.value = valor;
                return;
            }

            // Se tiver exatamente 3 dígitos, coloca vírgula depois dos 2 primeiros (ex: "753" → "75,3")
            if (valor.length === 3)
                valor = valor.slice(0, 2) + ',' + valor.slice(2);

            // Se tiver 4 ou mais dígitos, coloca vírgula depois dos 3 primeiros e limita a 2 casas decimais (ex: "75345" → "753,45")
            else if (valor.length >= 4)
                valor = valor.slice(0, 3) + ',' + valor.slice(3, 5);

            // Garante que o valor final não ultrapasse 7 caracteres (ex: "999,99")
            if (valor.length > 7)
                valor = valor.slice(0, 7);

            // Atualiza o valor formatado no input
            campo.value = valor;
        }

        function limpar() {
            res.style.display = 'none'
        }
    </script>
</body>

</html>